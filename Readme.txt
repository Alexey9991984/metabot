Как работает код:

Открытие сделок:

Бот анализирует данные о ценах (свечи) с использованием индикаторов SMA (периоды 5 и 20).

Когда SMA5 пересекает SMA20 (например, SMA5 выше SMA20), бот открывает покупку (buy), если это не сделано ранее.

Когда SMA5 пересекает SMA20 в другую сторону (например, SMA5 ниже SMA20), бот открывает продажу (sell), если это не сделано ранее.

Закрытие позиций:

Перед открытием новой сделки бот проверяет, есть ли открытые позиции. Если есть, они закрываются с помощью функции close_open_positions().

Закрытие позиции происходит через запрос к MetaTrader 5 с указанием типа ордера (продажа или покупка) и цены.